<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Fábrica V68 Titan 2.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body{background:#050505;color:#e2e8f0;font-family:'Segoe UI', sans-serif}
        .hidden{display:none!important}
        .tab-active{border-bottom:2px solid #10b981;color:#10b981}
        #code-editor{background:#111;color:#6ee7b7;font-family:'Courier New', monospace;font-size:12px;white-space:pre;overflow:auto}
        .chk:checked+div{background:#064e3b;border-color:#10b981;color:#fff;box-shadow: 0 0 10px rgba(16, 185, 129, 0.3)}
        /* Scrollbar customizada */
        ::-webkit-scrollbar {width: 6px;}
        ::-webkit-scrollbar-track {background: #111;}
        ::-webkit-scrollbar-thumb {background: #333; border-radius: 3px;}
        ::-webkit-scrollbar-thumb:hover {background: #10b981;}
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- LOGIN SCREEN -->
    <div id="view-login" class="flex-1 flex items-center justify-center p-6 bg-black z-50 absolute inset-0">
        <div class="bg-gray-900/80 backdrop-blur p-8 rounded-2xl w-full max-w-sm text-center border border-gray-800 shadow-2xl">
            <div class="relative inline-block">
                <i class="fas fa-robot text-6xl text-emerald-500 mb-4 animate-bounce"></i>
                <div class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full animate-pulse"></div>
            </div>
            <h1 class="text-3xl font-bold mb-1 text-white tracking-tighter">TITAN <span class="text-emerald-500">V68</span></h1>
            <p class="text-xs text-gray-500 mb-6 font-mono">APP FACTORY SYSTEM</p>
            
            <div class="space-y-3">
                <input type="password" id="tkn" placeholder="GitHub Token (ghp_...)" class="w-full bg-black/50 border border-gray-700 rounded-lg p-3 text-center text-emerald-400 font-mono text-xs focus:border-emerald-500 outline-none transition">
                <div class="grid grid-cols-2 gap-2">
                    <input type="text" id="cfg-user" placeholder="Usuário GitHub" class="bg-black/50 border border-gray-700 rounded-lg p-3 text-center text-gray-300 text-xs outline-none">
                    <input type="text" id="cfg-repo" placeholder="Nome Repositório" class="bg-black/50 border border-gray-700 rounded-lg p-3 text-center text-gray-300 text-xs outline-none">
                </div>
                <button onclick="login()" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-3.5 rounded-lg shadow-lg hover:shadow-emerald-500/20 transition transform active:scale-95">ACESSAR PAINEL</button>
            </div>
            <p class="mt-4 text-[10px] text-gray-600">Certifique-se que o token tem permissão 'workflow'</p>
        </div>
    </div>

    <!-- MAIN APP -->
    <div id="view-main" class="hidden flex flex-col h-full bg-gradient-to-b from-gray-900 to-black">
        <!-- HEADER -->
        <div class="px-4 py-3 bg-gray-900/90 backdrop-blur border-b border-gray-800 flex justify-between items-center shadow-lg shrink-0 z-10">
            <div class="font-bold text-emerald-500 flex items-center gap-2 text-lg">
                <i class="fas fa-microchip"></i> 
                <span id="repo-display">V68</span>
            </div>
            <div class="flex gap-6 text-xs font-bold uppercase tracking-widest">
                <button onclick="tab('editor')" id="tab-editor" class="tab-active pb-1 hover:text-white transition">App</button>
                <button onclick="tab('plugins')" id="tab-plugins" class="pb-1 text-gray-500 hover:text-white transition">Plugins</button>
                <button onclick="tab('history')" id="tab-history" class="pb-1 text-gray-500 hover:text-white transition">Builds</button>
            </div>
            <button onclick="logout()" class="text-gray-600 hover:text-red-500 transition"><i class="fas fa-sign-out-alt"></i></button>
        </div>

        <!-- EDITOR TAB -->
        <div id="content-editor" class="flex-1 overflow-y-auto p-4 space-y-4">
            <!-- App Info -->
            <div class="bg-gray-800/40 p-4 rounded-xl border border-gray-700/50">
                <input type="text" id="name" placeholder="Nome do Aplicativo" class="w-full bg-transparent text-xl font-bold outline-none mb-3 placeholder-gray-600 text-white">
                <div class="flex gap-2">
                    <div class="flex-1 bg-black/40 rounded-lg border border-gray-700 flex items-center px-3">
                        <span class="text-gray-500 text-xs mr-2"><i class="fas fa-box"></i></span>
                        <input type="text" id="pkg" placeholder="com.seuapp.v68" class="w-full bg-transparent py-2 text-xs font-mono text-emerald-400 outline-none">
                    </div>
                    <div class="w-20 bg-black/40 rounded-lg border border-gray-700 flex items-center px-2">
                        <input type="text" id="ver" placeholder="1.0.0" class="w-full bg-transparent py-2 text-xs text-center text-gray-400 outline-none">
                    </div>
                </div>
            </div>

            <!-- HTML Code -->
            <div class="relative group">
                <div class="flex justify-between items-end mb-2 px-1">
                    <label class="text-[10px] font-bold text-gray-400 tracking-wider">CÓDIGO FONTE (HTML/JS)</label>
                    <button onclick="$('f-index').click()" class="text-[10px] bg-gray-800 text-gray-300 px-3 py-1 rounded-full hover:bg-emerald-600 hover:text-white transition border border-gray-700">
                        <i class="fas fa-file-upload mr-1"></i> Importar HTML
                    </button>
                </div>
                <textarea id="code-editor" class="w-full h-40 p-3 rounded-xl border border-gray-800 outline-none resize-none focus:border-emerald-600 transition shadow-inner" placeholder="Cole seu código HTML aqui..."></textarea>
                <input type="file" id="f-index" class="hidden" accept=".html,.txt" onchange="loadFile(this)">
            </div>

            <!-- Assets -->
            <div class="grid grid-cols-2 gap-3">
                <div onclick="$('f-icon').click()" class="bg-gray-800/50 h-20 rounded-xl border border-gray-700/50 flex flex-col items-center justify-center cursor-pointer relative overflow-hidden group hover:border-emerald-500 hover:bg-gray-800 transition">
                    <i class="fas fa-icons text-2xl text-gray-600 mb-1 group-hover:text-emerald-500 transition"></i>
                    <span class="text-[9px] font-bold text-gray-500">ÍCONE (512px)</span>
                    <img id="prev-icon" class="absolute inset-0 w-full h-full object-cover hidden">
                    <div class="absolute top-1 right-1 w-2 h-2 bg-emerald-500 rounded-full hidden" id="dot-icon"></div>
                </div>
                <div onclick="$('f-splash').click()" class="bg-gray-800/50 h-20 rounded-xl border border-gray-700/50 flex flex-col items-center justify-center cursor-pointer relative overflow-hidden group hover:border-emerald-500 hover:bg-gray-800 transition">
                    <i class="fas fa-mobile-alt text-2xl text-gray-600 mb-1 group-hover:text-emerald-500 transition"></i>
                    <span class="text-[9px] font-bold text-gray-500">SPLASH (Fundo)</span>
                    <img id="prev-splash" class="absolute inset-0 w-full h-full object-cover hidden">
                    <div class="absolute top-1 right-1 w-2 h-2 bg-emerald-500 rounded-full hidden" id="dot-splash"></div>
                </div>
                <input type="file" id="f-icon" class="hidden" accept="image/png,image/jpeg" onchange="preview(this,'prev-icon')">
                <input type="file" id="f-splash" class="hidden" accept="image/png,image/jpeg" onchange="preview(this,'prev-splash')">
            </div>
            
            <!-- Settings -->
            <div class="grid grid-cols-2 gap-3">
                <div>
                    <label class="text-[9px] font-bold text-gray-500 ml-1">ORIENTAÇÃO</label>
                    <div class="relative mt-1">
                        <select id="orient" class="w-full bg-gray-900 border border-gray-800 rounded-lg p-2.5 text-xs outline-none text-gray-300 appearance-none">
                            <option value="default">Automático</option>
                            <option value="portrait">Em Pé (Retrato)</option>
                            <option value="landscape">Deitado (Paisagem)</option>
                        </select>
                        <i class="fas fa-chevron-down absolute right-3 top-3 text-gray-600 text-xs pointer-events-none"></i>
                    </div>
                </div>
                <div>
                    <label class="text-[9px] font-bold text-gray-500 ml-1">COR BARRA STATUS</label>
                    <div class="flex items-center gap-2 mt-1">
                        <input type="color" id="status-color" value="#000000" class="w-full h-9 bg-gray-900 border border-gray-800 rounded-lg cursor-pointer p-1">
                    </div>
                </div>
            </div>
        </div>

        <!-- PLUGINS TAB -->
        <div id="content-plugins" class="hidden flex-1 overflow-y-auto p-4 space-y-5">
            <div>
                <h3 class="text-[10px] font-bold text-emerald-500 uppercase tracking-widest mb-3 flex items-center gap-2">
                    <i class="fas fa-cube"></i> Essenciais
                </h3>
                <div class="grid grid-cols-4 gap-2 text-[8px] font-bold text-gray-400 select-none">
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-notif" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">NOTIF<br><i class="fas fa-bell mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-cam" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">CÂMERA<br><i class="fas fa-camera mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-file" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">ARQUIVOS<br><i class="fas fa-folder mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-geo" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">GPS<br><i class="fas fa-map-marker-alt mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-vib" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">VIBRA<br><i class="fas fa-mobile mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-mic" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">MIC<br><i class="fas fa-microphone mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-flash" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">FLASH<br><i class="fas fa-bolt mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-bat" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">BATERIA<br><i class="fas fa-battery-half mt-1 text-xs"></i></div></label>
                </div>
            </div>

            <div>
                <h3 class="text-[10px] font-bold text-blue-400 uppercase tracking-widest mb-3 flex items-center gap-2 pt-2 border-t border-gray-800">
                    <i class="fas fa-star"></i> Avançados
                </h3>
                <div class="grid grid-cols-3 gap-2 text-[8px] font-bold text-gray-400 select-none">
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-bright" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">BRILHO<br><i class="fas fa-sun mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-bio" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">BIOMETRIA<br><i class="fas fa-fingerprint mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-tts" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">FALA (TTS)<br><i class="fas fa-comment-dots mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-share" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">SHARE<br><i class="fas fa-share-alt mt-1 text-xs"></i></div></label>
                    <label class="cursor-pointer relative group"><input type="checkbox" id="c-insomnia" class="chk hidden"><div class="p-3 bg-gray-900 rounded-lg border border-gray-800 text-center transition group-hover:border-gray-600">TELA LIGADA<br><i class="fas fa-eye mt-1 text-xs"></i></div></label>
                </div>
            </div>
            
            <div class="mt-4 bg-gray-900/50 border border-gray-800 rounded-xl p-4">
                <label class="text-[10px] font-bold text-blue-500 block mb-2 flex items-center gap-2"><i class="fab fa-google"></i> ADMOB (BANNER ID)</label>
                <input type="text" id="ad-id" placeholder="ca-app-pub-xxxxxxxx/xxxxxxx" class="w-full bg-black p-3 rounded-lg border border-gray-700 text-xs text-gray-300 focus:border-blue-500 outline-none transition font-mono">
            </div>
        </div>

        <!-- HISTORY TAB -->
        <div id="content-history" class="hidden flex-1 overflow-y-auto p-4">
            <div class="flex justify-between items-center mb-4">
                 <h2 class="text-xs font-bold text-gray-500">HISTÓRICO DE VERSÕES</h2>
                 <button onclick="loadHistory()" class="text-emerald-500 text-xs hover:underline"><i class="fas fa-sync"></i> Atualizar</button>
            </div>
            <div id="hist-list" class="space-y-2">
                <div class="text-center text-xs mt-10 text-gray-600 animate-pulse">Buscando...</div>
            </div>
        </div>

        <!-- FOOTER / CONSOLE -->
        <div id="logs" class="px-4 py-1 text-[10px] font-mono text-emerald-500/80 h-6 overflow-hidden bg-black border-t border-gray-800 truncate select-all">
            > Sistema pronto. Aguardando comando...
        </div>

        <div class="p-4 bg-gray-900 border-t border-gray-800 shrink-0 z-20">
            <button id="btn-build" onclick="build()" class="w-full bg-gradient-to-r from-emerald-700 to-emerald-600 text-white font-bold py-4 rounded-xl shadow-lg hover:shadow-emerald-500/20 hover:brightness-110 transition active:scale-95 flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed">
                <i class="fas fa-rocket text-lg"></i> <span id="btn-text">INICIAR FÁBRICA</span>
            </button>
        </div>
    </div>

    <script>
        const $ = id => document.getElementById(id);
        const log = m => { const el=$('logs'); el.innerText = "> " + m; el.style.color = m.includes('Erro')?'#ef4444':'#10b981'; };

        // Configuration - Valores Padrão Definidos Aqui
        let REPO_USER = localStorage.getItem('cfg_user') || "gamerkaua00";
        let REPO_NAME = localStorage.getItem('cfg_repo') || "Maquina-Apks";

        // Init
        window.onload = () => {
            // Preencher inputs com os valores (padrão ou salvos)
            $('cfg-user').value = REPO_USER;
            $('cfg-repo').value = REPO_NAME;

            const tk = localStorage.getItem('tk');
            if(tk) {
                $('tkn').value = tk;
                
                // Só faz login automático se tiver usuário e repo definidos (agora sempre terá)
                if(REPO_USER && REPO_NAME) {
                    toggleView(true);
                    loadHistory();
                }
            }
        };

        function login() {
            const t = $('tkn').value.trim();
            const u = $('cfg-user').value.trim();
            const r = $('cfg-repo').value.trim();

            if(!t.startsWith('ghp_') && !t.startsWith('github_pat_')) return alert('Token inválido! Deve começar com ghp_ ou github_pat_');
            if(!u || !r) return alert('Preencha Usuário e Repositório!');

            localStorage.setItem('tk', t);
            localStorage.setItem('cfg_user', u);
            localStorage.setItem('cfg_repo', r);
            REPO_USER = u; REPO_NAME = r;
            
            toggleView(true);
        }

        function logout() {
            localStorage.removeItem('tk');
            location.reload();
        }

        function toggleView(logged) {
            if(logged) {
                $('view-login').classList.add('hidden');
                $('view-main').classList.remove('hidden');
                $('repo-display').innerText = REPO_NAME;
            } else {
                $('view-login').classList.remove('hidden');
                $('view-main').classList.add('hidden');
            }
        }

        function tab(t) {
            ['editor','plugins','history'].forEach(x => {
                $(`content-${x}`).classList.add('hidden');
                $(`tab-${x}`).classList.remove('tab-active','text-emerald-500','text-white');
                $(`tab-${x}`).classList.add('text-gray-500');
            });
            $(`content-${t}`).classList.remove('hidden');
            $(`tab-${t}`).classList.add('tab-active','text-white');
            $(`tab-${t}`).classList.remove('text-gray-500');
            if(t==='history') loadHistory();
        }

        function preview(input, imgId) {
            if(input.files[0]){
                const r = new FileReader();
                r.onload = e => {
                    $(imgId).src = e.target.result;
                    $(imgId).classList.remove('hidden');
                    $(`dot-${imgId.split('-')[1]}`).classList.remove('hidden');
                };
                r.readAsDataURL(input.files[0]);
            }
        }

        function loadFile(input) {
            if(input.files[0]){
                const r = new FileReader();
                r.onload = e => $('code-editor').value = e.target.result;
                r.readAsText(input.files[0]);
            }
        }

        const toB64 = f => new Promise((resolve, reject) => {
            const r = new FileReader();
            r.readAsDataURL(f);
            r.onload = () => resolve(r.result.split(',')[1]);
            r.onerror = error => reject(error);
        });

        // GitHub API Helper
        async function ghApi(endpoint, method='GET', body=null) {
            const t = localStorage.getItem('tk');
            const opts = {
                method: method,
                headers: {
                    'Authorization': `token ${t}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                }
            };
            if(body) opts.body = JSON.stringify(body);
            const r = await fetch(`https://api.github.com/repos/${REPO_USER}/${REPO_NAME}/${endpoint}`, opts);
            if(!r.ok && r.status !== 404) throw new Error(`Erro GitHub: ${r.status}`);
            return r;
        }

        async function upload(path, content, msg) {
            // Get SHA if exists
            let sha = null;
            try {
                const r = await ghApi(`contents/${path}`);
                if(r.ok) sha = (await r.json()).sha;
            } catch(e) {}

            const body = { message: msg, content: content, branch: "main" };
            if(sha) body.sha = sha;

            await ghApi(`contents/${path}`, 'PUT', body);
        }

        async function build() {
            const btn = $('btn-build');
            const txt = $('btn-text');
            const code = $('code-editor').value;

            if(!code) return alert("Erro: O campo de código HTML está vazio!");
            if(!$('name').value) return alert("Erro: Defina um nome para o App!");

            btn.disabled = true;
            txt.innerText = "ENVIANDO ARQUIVOS...";
            
            try {
                // 1. Upload Core
                log("Enviando código fonte...");
                // UTF-8 fix for base64
                const b64Html = btoa(unescape(encodeURIComponent(code)));
                await upload("www/index.html", b64Html, "Update App Core");

                // 2. Images
                const fIco = $('f-icon').files[0];
                if(fIco) { log("Enviando ícone..."); await upload("www/icon.png", await toB64(fIco), "Update Icon"); }
                
                const fSpl = $('f-splash').files[0];
                if(fSpl) { log("Enviando splash..."); await upload("www/splash.png", await toB64(fSpl), "Update Splash"); }

                // 3. Config
                log("Configurando parâmetros...");
                const feat = {
                    appName: $('name').value, 
                    packageId: $('pkg').value || "com.titan.app", 
                    version: $('ver').value || "1.0.0",
                    hasSplash: !!fSpl, 
                    orientation: $('orient').value, 
                    statusBarColor: $('status-color').value,
                    admobId: $('ad-id').value,
                    // Plugins mapping
                    notification: $('c-notif').checked, 
                    camera: $('c-cam').checked, 
                    file: $('c-file').checked,
                    geolocation: $('c-geo').checked, 
                    vibration: $('c-vib').checked, 
                    microphone: $('c-mic').checked,
                    flashlight: $('c-flash').checked, 
                    battery: $('c-bat').checked, 
                    brightness: $('c-bright').checked, 
                    biometric: $('c-bio').checked, 
                    share: $('c-share').checked, 
                    tts: $('c-tts').checked,
                    insomnia: $('c-insomnia').checked,
                    admob: !!$('ad-id').value
                };
                
                // Trigger Build via config file change
                await upload("features.json", btoa(unescape(encodeURIComponent(JSON.stringify(feat)))), "TRIGGER BUILD");
                
                txt.innerText = "COMPILANDO NO SERVIDOR...";
                monitor(new Date().toISOString());

            } catch(e) {
                alert("Erro: " + e.message);
                log("Erro na operação");
                btn.disabled = false;
                txt.innerText = "TENTAR NOVAMENTE";
            }
        }

        async function monitor(startTime) {
            log("Aguardando robô iniciar...");
            let runId = null;
            let attempts = 0;

            const int = setInterval(async () => {
                try {
                    attempts++;
                    // Stop after 5 mins
                    if(attempts > 75) { clearInterval(int); resetBtn(); return alert("Tempo limite excedido."); }

                    const r = await ghApi('actions/runs?per_page=1');
                    const d = await r.json();
                    
                    if(!d.workflow_runs || d.workflow_runs.length === 0) return;

                    const run = d.workflow_runs[0];
                    
                    // Check if run is newer than our click time (avoiding old cached runs)
                    const runDate = new Date(run.created_at);
                    const clickDate = new Date(startTime);
                    
                    // Logic: Needs to be created AFTER we clicked build (with 5s buffer for clock drift)
                    if (runDate < new Date(clickDate.getTime() - 5000)) {
                        log(`Aguardando fila... (${attempts})`);
                        return;
                    }

                    runId = run.id;

                    if(run.status === "completed") {
                        clearInterval(int);
                        resetBtn();
                        if(run.conclusion === "success") {
                            log("Sucesso!");
                            tab('history');
                            // Trigger confetti or success sound here if wanted
                        } else {
                            log("Falha na compilação.");
                            alert("❌ A compilação falhou. Verifique os logs no GitHub.");
                        }
                    } else {
                        log(`Construindo: ${run.status} (${Math.round((Date.now() - runDate)/1000)}s)`);
                    }

                } catch(e) { console.error(e); }
            }, 4000);
        }

        function resetBtn() {
            $('btn-build').disabled = false;
            $('btn-text').innerText = "CRIAR NOVA BUILD";
        }

        async function loadHistory() {
            const l = $('hist-list');
            try {
                const r = await ghApi('releases?per_page=10');
                const d = await r.json();
                
                l.innerHTML = '';
                if(d.length === 0) { l.innerHTML = '<div class="text-center text-gray-600 text-xs">Nenhuma build encontrada.</div>'; return; }

                d.forEach(rel => {
                    const date = new Date(rel.published_at).toLocaleString();
                    let downloadHtml = '';
                    
                    if(rel.assets && rel.assets.length > 0) {
                        rel.assets.forEach(asset => {
                             downloadHtml += `<a href="${asset.browser_download_url}" class="block mt-2 bg-emerald-900/50 border border-emerald-700 hover:bg-emerald-700 text-emerald-100 px-3 py-2 rounded text-xs font-bold text-center transition"><i class="fas fa-download mr-1"></i> BAIXAR ${asset.name}</a>`;
                        });
                    } else {
                        downloadHtml = `<div class="mt-2 text-[10px] text-red-400 border border-red-900/30 bg-red-900/10 p-1 rounded text-center">Processando ou Falhou</div>`;
                    }

                    l.innerHTML += `
                        <div class="bg-gray-800 p-3 rounded-lg border border-gray-700 hover:border-gray-600 transition">
                            <div class="flex justify-between items-start">
                                <div>
                                    <div class="font-bold text-sm text-emerald-400">${rel.name || rel.tag_name}</div>
                                    <div class="text-[10px] text-gray-500 font-mono">${date}</div>
                                </div>
                                <a href="${rel.html_url}" target="_blank" class="text-gray-500 hover:text-white"><i class="fas fa-external-link-alt"></i></a>
                            </div>
                            ${downloadHtml}
                        </div>
                    `;
                });
            } catch(e) {
                l.innerHTML = '<div class="text-center text-red-500 text-xs">Erro ao carregar histórico. Verifique o Token.</div>';
            }
        }
    </script>
</body>
</html>
